<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8.4.5. TIP5P water model &mdash; LAMMPS documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sphinx-design.min.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />
    <link rel="shortcut icon" href="_static/lammps.ico"/>
    <link rel="canonical" href="https://docs.lammps.org/Howto_tip5p.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9bcbadda"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/design-tabs.js?v=f930bc37"></script>
        <script async="async" src="_static/mathjax/es5/tex-mml-chtml.js?v=cadf963e"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8.4.6. SPC water model" href="Howto_spc.html" />
    <link rel="prev" title="8.4.4. TIP4P water model" href="Howto_tip4p.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="Manual.html">
            
              <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          </a>
            <div class="lammps_version">Version: <b>19 Nov 2024</b></div>
            <div class="lammps_release">git info: </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Howto.html">8. Howto discussions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Howto.html#general-howto">8.1. General howto</a></li>
<li class="toctree-l2"><a class="reference internal" href="Howto.html#settings-howto">8.2. Settings howto</a></li>
<li class="toctree-l2"><a class="reference internal" href="Howto.html#analysis-howto">8.3. Analysis howto</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="Howto.html#force-fields-howto">8.4. Force fields howto</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Howto_bioFF.html">8.4.1. CHARMM, AMBER, COMPASS, DREIDING, and OPLS force fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="Howto_amoeba.html">8.4.2. AMOEBA and HIPPO force fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="Howto_tip3p.html">8.4.3. TIP3P water model</a></li>
<li class="toctree-l3"><a class="reference internal" href="Howto_tip4p.html">8.4.4. TIP4P water model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">8.4.5. TIP5P water model</a></li>
<li class="toctree-l3"><a class="reference internal" href="Howto_spc.html">8.4.6. SPC water model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Howto.html#packages-howto">8.5. Packages howto</a></li>
<li class="toctree-l2"><a class="reference internal" href="Howto.html#tutorials-howto">8.6. Tutorials howto</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fix Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Compute Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dumps.html">Dump Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="Manual.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="Howto.html"><span class="section-number">8. </span>Howto discussions</a></li>
      <li class="breadcrumb-item active"><span class="section-number">8.4.5. </span>TIP5P water model</li>
      <li class="wy-breadcrumbs-aside">
          <a href="https://www.lammps.org"><img src="_static/lammps-logo.png" width="64" height="16" alt="LAMMPS Homepage"></a> | <a href="Commands_all.html">Commands</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="Howto_tip4p.html" class="btn btn-neutral float-left" title="8.4.4. TIP4P water model" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Howto_spc.html" class="btn btn-neutral float-right" title="8.4.6. SPC water model" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\renewcommand{\AA}{\text{Å}}\)</span></p>
<section id="tip5p-water-model">
<h1><span class="section-number">8.4.5. </span>TIP5P water model<a class="headerlink" href="#tip5p-water-model" title="Link to this heading"></a></h1>
<p>The five-point TIP5P rigid water model extends the <a class="reference internal" href="Howto_tip3p.html"><span class="doc">three-point
TIP3P model</span></a> by adding two additional sites L, usually
massless, where the charge associated with the oxygen atom is placed.
These sites L are located at a fixed distance away from the oxygen atom,
forming a tetrahedral angle that is rotated by 90 degrees from the HOH
plane.  Those sites thus somewhat approximate lone pairs of the oxygen
and consequently improve the water structure to become even more
“tetrahedral” in comparison to the <a class="reference internal" href="Howto_tip4p.html"><span class="doc">four-point TIP4P model</span></a>.</p>
<p>A suitable pair style with cutoff Coulomb would be:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pair_lj_cut_coul.html"><span class="doc">pair_style lj/cut/coul/cut</span></a></p></li>
</ul>
<p>or these commands for a long-range model:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pair_lj_cut_coul.html"><span class="doc">pair_style lj/cut/coul/long</span></a></p></li>
<li><p><a class="reference internal" href="pair_fep_soft.html"><span class="doc">pair_style lj/cut/coul/long/soft</span></a></p></li>
<li><p><a class="reference internal" href="kspace_style.html"><span class="doc">kspace_style pppm</span></a></p></li>
<li><p><a class="reference internal" href="kspace_style.html"><span class="doc">kspace_style pppm/disp</span></a></p></li>
</ul>
<p>A TIP5P model <em>must</em> be run using a <a class="reference internal" href="fix_rigid.html"><span class="doc">rigid fix</span></a> since
there is no other option to keep this kind of structure rigid in LAMMPS.
In order to avoid that LAMMPS produces an error due to the massless L
sites, those need to be assigned a tiny non-zero mass.</p>
<p>The table below lists the force field parameters (in real <a class="reference internal" href="units.html"><span class="doc">units</span></a>) to for a the TIP5P model with a cutoff <a class="reference internal" href="#mahoney"><span class="std std-ref">(Mahoney)</span></a> and the TIP5P-E model <a class="reference internal" href="#rick"><span class="std std-ref">(Rick)</span></a> for use with a
long-range Coulombic solver (e.g. Ewald or PPPM in LAMMPS).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>TIP5P</p></th>
<th class="head"><p>TIP5P-E</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>O mass (amu)</p></td>
<td><p>15.9994</p></td>
<td><p>15.9994</p></td>
</tr>
<tr class="row-odd"><td><p>H mass (amu)</p></td>
<td><p>1.008</p></td>
<td><p>1.008</p></td>
</tr>
<tr class="row-even"><td><p>O charge (<span class="math notranslate nohighlight">\(e\)</span>)</p></td>
<td><p>0.0</p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p>L charge (<span class="math notranslate nohighlight">\(e\)</span>)</p></td>
<td><p>-0.241</p></td>
<td><p>-0.241</p></td>
</tr>
<tr class="row-even"><td><p>H charge (<span class="math notranslate nohighlight">\(e\)</span>)</p></td>
<td><p>0.241</p></td>
<td><p>0.241</p></td>
</tr>
<tr class="row-odd"><td><p>LJ <span class="math notranslate nohighlight">\(\epsilon\)</span> of OO (kcal/mole)</p></td>
<td><p>0.1600</p></td>
<td><p>0.1780</p></td>
</tr>
<tr class="row-even"><td><p>LJ <span class="math notranslate nohighlight">\(\sigma\)</span> of OO (<span class="math notranslate nohighlight">\(\AA\)</span>)</p></td>
<td><p>3.1200</p></td>
<td><p>3.0970</p></td>
</tr>
<tr class="row-odd"><td><p>LJ <span class="math notranslate nohighlight">\(\epsilon\)</span> of HH, LL, OH, OL, HL (kcal/mole)</p></td>
<td><p>0.0</p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p>LJ <span class="math notranslate nohighlight">\(\sigma\)</span> of HH, LL, OH, OL, HL (<span class="math notranslate nohighlight">\(\AA\)</span>)</p></td>
<td><p>1.0</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(r_0\)</span> of OH bond (<span class="math notranslate nohighlight">\(\AA\)</span>)</p></td>
<td><p>0.9572</p></td>
<td><p>0.9572</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_0\)</span> of HOH angle</p></td>
<td><p>104.52<span class="math notranslate nohighlight">\(^{\circ}\)</span></p></td>
<td><p>104.52<span class="math notranslate nohighlight">\(^{\circ}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>OL distance (<span class="math notranslate nohighlight">\(\AA\)</span>)</p></td>
<td><p>0.70</p></td>
<td><p>0.70</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_0\)</span> of LOL angle</p></td>
<td><p>109.47<span class="math notranslate nohighlight">\(^{\circ}\)</span></p></td>
<td><p>109.47<span class="math notranslate nohighlight">\(^{\circ}\)</span></p></td>
</tr>
</tbody>
</table>
<p>Below is the code for a LAMMPS input file for setting up a simulation of
TIP5P water with a molecule file.  Because of using <a class="reference internal" href="fix_rigid.html"><span class="doc">fix
rigid/small</span></a> no bonds need to be defined and thus no extra
storage needs to be reserved for them, but we need to either switch to
atom style full or use <a class="reference internal" href="fix_property_atom.html"><span class="doc">fix property/atom mol</span></a>
so that fix rigid/small can identify rigid bodies by their molecule ID.
Also a <a class="reference internal" href="neigh_modify.html"><span class="doc">neigh_modify exclude</span></a> command is added to
exclude computing intramolecular non-bonded interactions, since those
are removed by the rigid fix anyway:</p>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">charge</span>
<span class="k">atom_modify</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">array</span>
<span class="k">region </span><span class="nv nv-Identifier">box</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="m">5</span><span class="w"> </span><span class="m">5</span>
<span class="k">create_box </span><span class="nv nv-Identifier">3</span><span class="w"> </span><span class="nv nv-Identifier">box</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">15.9994</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1.008</span>
<span class="k">mass</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1.0e-100</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">coul</span><span class="o">/</span><span class="n">cut</span><span class="w"> </span><span class="m">8.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.160</span><span class="w">  </span><span class="m">3.12</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.0</span><span class="w">    </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0.0</span><span class="w">    </span><span class="m">1.0</span>

<span class="k">fix </span><span class="nv nv-Identifier">mol</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">property</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="n">mol</span>
<span class="k">molecule</span><span class="w"> </span><span class="n">water</span><span class="w"> </span><span class="n">tip5p.mol</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">34564</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">water</span><span class="w"> </span><span class="m">25367</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">1.33</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">exclude</span><span class="w"> </span><span class="n">molecule</span><span class="o">/</span><span class="n">intra</span><span class="w"> </span><span class="n">all</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>
<span class="k">fix </span><span class="nv nv-Identifier">integrate</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">rigid</span><span class="o">/</span><span class="n">small</span><span class="w"> </span><span class="n">molecule</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">50.0</span><span class="w"> </span><span class="m">235664</span>
<span class="k">reset_timestep</span><span class="w"> </span><span class="m">0</span>

<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">density</span><span class="w"> </span><span class="n">pe</span><span class="w"> </span><span class="n">ke</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">1000</span>
<span class="k">run</span><span class="w"> </span><span class="m">20000</span>
<span class="k">write_data </span><span class="nv nv-Identifier">tip5p.data</span><span class="w"> </span><span class="n">nocoeff</span>
</pre></div>
</div>
<div class="highlight-none notranslate" id="tip5p-molecule"><div class="highlight"><pre><span></span># Water molecule. Explicit TIP5P geometry for use with fix rigid

5 atoms

Coords

1    0.00000  -0.06556   0.00000
2    0.75695   0.52032   0.00000
3   -0.75695   0.52032   0.00000
4    0.00000  -0.46971   0.57154
5    0.00000  -0.46971  -0.57154

Types

1        1   # O
2        2   # H
3        2   # H
4        3   # L
5        3   # L

Charges

1        0.000
2        0.241
3        0.241
4       -0.241
5       -0.241
</pre></div>
</div>
<p>Wikipedia also has a nice article on <a class="reference external" href="https://en.wikipedia.org/wiki/Water_model">water models</a>.</p>
<hr class="docutils" />
<p id="mahoney"><strong>(Mahoney)</strong> Mahoney, Jorgensen, J Chem Phys 112, 8910 (2000)</p>
<p id="rick"><strong>(Rick)</strong> Rick, J Chem Phys 120, 6085 (2004)</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Howto_tip4p.html" class="btn btn-neutral float-left" title="8.4.4. TIP4P water model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Howto_spc.html" class="btn btn-neutral float-right" title="8.4.6. SPC water model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2003-2025 Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>